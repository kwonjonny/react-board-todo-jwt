{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { getCookie, setCookie } from \"../util/cookieUtil\";\nimport { postLogin } from \"../api/memberApi\";\n\n// Thunk 는 파라미터를 선언해놓고 람다로 만든다음 그안에서 비동기호 출 \nexport const postLoginThunk = createAsyncThunk('postLoginThunk', params => {\n  return postLogin(params);\n});\nconst loadCookie = () => {\n  const loginObj = getCookie(\"login\");\n  console.log(\"loginObj: \", loginObj);\n  if (!loginObj) {\n    return initState;\n  }\n  return loginObj;\n};\nconst initState = {\n  email: '',\n  nickname: '',\n  admin: false,\n  signed: false,\n  loading: false,\n  errosMsg: null\n};\nconst loginSlice = createSlice({\n  name: 'loginSlice',\n  // 초기 결과를 LoadCookie를 해서 그 결과를 loginObj로 \n  initialState: loadCookie(),\n  reducers: {\n    requestLogin: (state, action) => {\n      const payload = action.payload;\n      console.log(\"loginSlice requestLogin: \", payload);\n\n      // 다음으로 유지해야하는 함수를 반한 pure function\n      const loginObj = {\n        email: payload.email,\n        signed: true\n      };\n      setCookie(\"login\", JSON.stringify(payload), 1);\n      return payload;\n    }\n  },\n  // 이 함수 엑스트라 리듀서는 return을 해주지않아도 그다음상태가 자동으로나옴 \n  extraReducers: builder => {\n    // fulfuilled 파라미터2개 \n    builder.addCase(postLoginThunk.fulfilled, (state, action) => {\n      console.log(\"fulfulled\", action.payload);\n      const {\n        email,\n        nickname,\n        admin,\n        errosMsg\n      } = action.payload;\n      if (errosMsg) {\n        state.errosMsg = errosMsg;\n        return;\n      }\n\n      // server에서나온 진짜 데이터 \n      state = action.payload;\n      // payload에 엑섹스 토큰과 리프레스토큰도잇다 \n\n      setCookie(\"login\", JSON.stringify(action.payload), 1);\n      return {\n        ...action.payload,\n        loading: false\n      };\n    }).addCase(postLoginThunk.pending, (state, action) => {\n      console.log(\"pending\");\n      state.loading = true;\n    }).addCase(postLoginThunk.rejected, (state, action) => {\n      console.log(\"rejected\");\n    });\n  }\n});\n\n// // 다른곳에서 쓰기위해 객체로 loginSlice.actions로 정의 \nexport const {\n  requestLogin\n} = loginSlice.actions;\n\n// 외부에 노출은 reducer로 노출시킨다 \nexport default loginSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","getCookie","setCookie","postLogin","postLoginThunk","params","loadCookie","loginObj","console","log","initState","email","nickname","admin","signed","loading","errosMsg","loginSlice","name","initialState","reducers","requestLogin","state","action","payload","JSON","stringify","extraReducers","builder","addCase","fulfilled","pending","rejected","actions","reducer"],"sources":["/Users/gwonseongjun/리액트 프로젝트/r02/src/reducers/loginSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { getCookie, setCookie } from \"../util/cookieUtil\";\nimport { postLogin } from \"../api/memberApi\";\n\n\n// Thunk 는 파라미터를 선언해놓고 람다로 만든다음 그안에서 비동기호 출 \nexport const postLoginThunk = createAsyncThunk('postLoginThunk', (params) => {\n    return postLogin(params)\n})\n\nconst loadCookie = () => {\n    const loginObj = getCookie(\"login\")\n\n    console.log(\"loginObj: \", loginObj)\n    if (!loginObj) {\n        return initState;\n    }\n    return loginObj;\n}\n\nconst initState = {\n    email: '',\n    nickname: '',\n    admin: false,\n    signed: false,\n    loading: false,\n    errosMsg: null\n}\n\nconst loginSlice = createSlice({\n\n    name: 'loginSlice',\n    // 초기 결과를 LoadCookie를 해서 그 결과를 loginObj로 \n    initialState: loadCookie(),\n    reducers: {\n        requestLogin: (state, action) => {\n            const payload = action.payload\n            console.log(\"loginSlice requestLogin: \", payload)\n\n            // 다음으로 유지해야하는 함수를 반한 pure function\n            const loginObj = { email: payload.email, signed: true }\n\n            setCookie(\"login\", JSON.stringify(payload), 1)\n\n            return payload;\n        }\n    },\n    // 이 함수 엑스트라 리듀서는 return을 해주지않아도 그다음상태가 자동으로나옴 \n    extraReducers: (builder) => {\n        // fulfuilled 파라미터2개 \n        builder.addCase(postLoginThunk.fulfilled, (state, action) => {\n            console.log(\"fulfulled\", action.payload)\n            const {email, nickname, admin, errosMsg} = action.payload;\n            \n            if(errosMsg) {\n               state.errosMsg = errosMsg\n               return \n            }\n\n            // server에서나온 진짜 데이터 \n            state = action.payload;\n            // payload에 엑섹스 토큰과 리프레스토큰도잇다 \n\n            setCookie(\"login\", JSON.stringify(action.payload), 1)\n\n            return {...action.payload, loading : false}\n        })\n            .addCase(postLoginThunk.pending, (state, action) => {\n                console.log(\"pending\")\n                state.loading = true;\n\n            })\n            .addCase(postLoginThunk.rejected, (state, action) => {\n                console.log(\"rejected\")\n            })\n    }\n})\n\n// // 다른곳에서 쓰기위해 객체로 loginSlice.actions로 정의 \nexport const { requestLogin } = loginSlice.actions\n\n// 외부에 노출은 reducer로 노출시킨다 \nexport default loginSlice.reducer\n\n"],"mappings":"AAAA,SAASA,gBAAgB,EAAEC,WAAW,QAAQ,kBAAkB;AAChE,SAASC,SAAS,EAAEC,SAAS,QAAQ,oBAAoB;AACzD,SAASC,SAAS,QAAQ,kBAAkB;;AAG5C;AACA,OAAO,MAAMC,cAAc,GAAGL,gBAAgB,CAAC,gBAAgB,EAAGM,MAAM,IAAK;EACzE,OAAOF,SAAS,CAACE,MAAM,CAAC;AAC5B,CAAC,CAAC;AAEF,MAAMC,UAAU,GAAGA,CAAA,KAAM;EACrB,MAAMC,QAAQ,GAAGN,SAAS,CAAC,OAAO,CAAC;EAEnCO,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEF,QAAQ,CAAC;EACnC,IAAI,CAACA,QAAQ,EAAE;IACX,OAAOG,SAAS;EACpB;EACA,OAAOH,QAAQ;AACnB,CAAC;AAED,MAAMG,SAAS,GAAG;EACdC,KAAK,EAAE,EAAE;EACTC,QAAQ,EAAE,EAAE;EACZC,KAAK,EAAE,KAAK;EACZC,MAAM,EAAE,KAAK;EACbC,OAAO,EAAE,KAAK;EACdC,QAAQ,EAAE;AACd,CAAC;AAED,MAAMC,UAAU,GAAGjB,WAAW,CAAC;EAE3BkB,IAAI,EAAE,YAAY;EAClB;EACAC,YAAY,EAAEb,UAAU,CAAC,CAAC;EAC1Bc,QAAQ,EAAE;IACNC,YAAY,EAAEA,CAACC,KAAK,EAAEC,MAAM,KAAK;MAC7B,MAAMC,OAAO,GAAGD,MAAM,CAACC,OAAO;MAC9BhB,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAEe,OAAO,CAAC;;MAEjD;MACA,MAAMjB,QAAQ,GAAG;QAAEI,KAAK,EAAEa,OAAO,CAACb,KAAK;QAAEG,MAAM,EAAE;MAAK,CAAC;MAEvDZ,SAAS,CAAC,OAAO,EAAEuB,IAAI,CAACC,SAAS,CAACF,OAAO,CAAC,EAAE,CAAC,CAAC;MAE9C,OAAOA,OAAO;IAClB;EACJ,CAAC;EACD;EACAG,aAAa,EAAGC,OAAO,IAAK;IACxB;IACAA,OAAO,CAACC,OAAO,CAACzB,cAAc,CAAC0B,SAAS,EAAE,CAACR,KAAK,EAAEC,MAAM,KAAK;MACzDf,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEc,MAAM,CAACC,OAAO,CAAC;MACxC,MAAM;QAACb,KAAK;QAAEC,QAAQ;QAAEC,KAAK;QAAEG;MAAQ,CAAC,GAAGO,MAAM,CAACC,OAAO;MAEzD,IAAGR,QAAQ,EAAE;QACVM,KAAK,CAACN,QAAQ,GAAGA,QAAQ;QACzB;MACH;;MAEA;MACAM,KAAK,GAAGC,MAAM,CAACC,OAAO;MACtB;;MAEAtB,SAAS,CAAC,OAAO,EAAEuB,IAAI,CAACC,SAAS,CAACH,MAAM,CAACC,OAAO,CAAC,EAAE,CAAC,CAAC;MAErD,OAAO;QAAC,GAAGD,MAAM,CAACC,OAAO;QAAET,OAAO,EAAG;MAAK,CAAC;IAC/C,CAAC,CAAC,CACGc,OAAO,CAACzB,cAAc,CAAC2B,OAAO,EAAE,CAACT,KAAK,EAAEC,MAAM,KAAK;MAChDf,OAAO,CAACC,GAAG,CAAC,SAAS,CAAC;MACtBa,KAAK,CAACP,OAAO,GAAG,IAAI;IAExB,CAAC,CAAC,CACDc,OAAO,CAACzB,cAAc,CAAC4B,QAAQ,EAAE,CAACV,KAAK,EAAEC,MAAM,KAAK;MACjDf,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;IAC3B,CAAC,CAAC;EACV;AACJ,CAAC,CAAC;;AAEF;AACA,OAAO,MAAM;EAAEY;AAAa,CAAC,GAAGJ,UAAU,CAACgB,OAAO;;AAElD;AACA,eAAehB,UAAU,CAACiB,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}